2025-05-24 19:11:52,560 - AIPoliDoc - DEBUG - 加载配置文件: config/api_config.json
2025-05-24 19:11:52,563 - AIPoliDoc - DEBUG - 加载配置文件: config/app_config.json
2025-05-24 19:11:52,576 - AIPoliDoc - DEBUG - 加载模板: 默认模板
2025-05-24 19:11:52,592 - AIPoliDoc - DEBUG - 加载模板: 研究论文格式
2025-05-24 19:11:52,593 - AIPoliDoc - INFO - 配置管理器初始化完成
2025-05-24 19:11:53,636 - AIPoliDoc - DEBUG - 初始化字体映射: {'宋体': 'SimSun', '黑体': 'SimHei', '楷体': 'KaiTi', '仿宋': 'FangSong', '微软雅黑': 'Microsoft YaHei UI', '微软雅黑 UI': 'Microsoft YaHei UI', 'Times New Roman': 'Times New Roman'}
2025-05-24 19:11:53,644 - AIPoliDoc - DEBUG - 加载模板: 默认模板
2025-05-24 19:11:53,654 - AIPoliDoc - DEBUG - 加载模板: 研究论文格式
2025-05-24 19:11:53,655 - AIPoliDoc - INFO - 排版规则管理器初始化完成，加载了 2 个模板
2025-05-24 19:11:53,655 - AIPoliDoc - INFO - AI连接器初始化完成，使用模型: deepseek-chat
2025-05-24 19:11:54,515 - AIPoliDoc - DEBUG - 保存配置文件: config/app_config.json
2025-05-24 19:11:54,520 - AIPoliDoc - INFO - 应用程序启动完成
2025-05-24 19:11:54,889 - AIPoliDoc - INFO - AI Word文档自动排版工具启动成功
2025-05-24 19:13:41,883 - AIPoliDoc - INFO - 已选择文档: /Users/chennl/Desktop/AI_coding/python_tool/AIPoliDoc/已排版/未排版/人工智能在学术论文排版中的应用研究.docx
2025-05-24 19:13:49,609 - AIPoliDoc - INFO - API配置验证成功
2025-05-24 19:13:49,619 - AIPoliDoc - INFO - 开始排版任务
2025-05-24 19:13:49,667 - AIPoliDoc - INFO - 成功读取文档: /Users/chennl/Desktop/AI_coding/python_tool/AIPoliDoc/已排版/未排版/人工智能在学术论文排版中的应用研究.docx
2025-05-24 19:13:49,676 - AIPoliDoc - DEBUG - 文档包含 79 个段落
2025-05-24 19:13:49,682 - AIPoliDoc - DEBUG - 完成文本特征分析，发现 17 个潜在标题
2025-05-24 19:13:49,689 - AIPoliDoc - DEBUG - 生成结构提示完成
2025-05-24 19:13:49,691 - AIPoliDoc - DEBUG - 文档长度: 1757 字符, 规则数量: 5
2025-05-24 19:13:49,698 - AIPoliDoc - DEBUG - 生成的提示词长度: 2802 字符
2025-05-24 19:13:49,712 - AIPoliDoc - DEBUG - 提示词开头: 
你是一个专业的文档排版助手。请分析以下未经排版的文档内容（全部使用默认正文格式），通过语义理解识别其中的结构元素（如标题、正文、列表等），并严格按照提供的排版规则，返回详细的排版指令。

文档内容：
# 人工智能在学术论文排版中的应用研究  

**中国科学技术大学·智能计算研究所** 张学术  



## 摘要  

随着学术论文数量的快速增长，传统排版方式已无法满足高效、规范的出版需求。本...
2025-05-24 19:13:49,715 - AIPoliDoc - DEBUG - 提示词结尾: ...type": "标题",
      "content": "文本内容",
      "format": {
        "font": "黑体",
        "size": "小二",
        "line_spacing": 1.0
      }
    },
    ...
  ]
}

请确保返回的JSON格式正确，可以被解析。只返回JSON内容，不要有其他说明文字。

2025-05-24 19:13:49,716 - AIPoliDoc - DEBUG - 生成AI提示词完成
2025-05-24 19:13:49,717 - AIPoliDoc - INFO - 发送请求到AI API: https://api.deepseek.com/chat/completions
2025-05-24 19:13:49,717 - AIPoliDoc - DEBUG - 请求头信息: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-c7d66ad568c849ffbd6563762abc0fdf'}
2025-05-24 19:13:49,718 - AIPoliDoc - DEBUG - 提示词预览: 
你是一个专业的文档排版助手。请分析以下未经排版的文档内容（全部使用默认正文格式），通过语义理解识别其中的结构元素（如标题、正文、列表等），并严格按照提供的排版规则，返回详细的排版指令。

文档内容：
# 人工智能在学术论文排版中的应用研究  

**中国科学技术大学·智能计算研究所** 张学术  



## 摘要  

随着学术论文数量的快速增长，传统排版方式已无法满足高效、规范的出版需求。本...
2025-05-24 19:13:49,719 - AIPoliDoc - DEBUG - 使用模型: deepseek-chat
2025-05-24 19:13:49,757 - AIPoliDoc - INFO - 开始发送请求，超时时间设置为180秒
2025-05-24 19:16:44,412 - AIPoliDoc - INFO - 收到响应，状态码: 200
2025-05-24 19:16:44,414 - AIPoliDoc - INFO - AI API请求成功
2025-05-24 19:16:44,417 - AIPoliDoc - DEBUG - 响应内容预览: {
  "elements": [
    {
      "type": "标题",
      "content": "人工智能在学术论文排版中的应用研究",
      "format": {
        "font": "黑体",
        "size": "小二",
        "line_spacing": 1.0
      }
    },
    {
      "...
2025-05-24 19:16:44,419 - AIPoliDoc - DEBUG - 响应使用的模型: deepseek-chat
2025-05-24 19:16:44,421 - AIPoliDoc - DEBUG - 令牌使用情况: {'prompt_tokens': 1398, 'completion_tokens': 4096, 'total_tokens': 5494, 'prompt_tokens_details': {'cached_tokens': 0}, 'prompt_cache_hit_tokens': 0, 'prompt_cache_miss_tokens': 1398}
2025-05-24 19:16:44,424 - AIPoliDoc - DEBUG - 响应完整结构的键: ['id', 'object', 'created', 'model', 'choices', 'usage', 'system_fingerprint']
2025-05-24 19:16:44,426 - AIPoliDoc - DEBUG - 令牌使用情况: {'prompt_tokens': 1398, 'completion_tokens': 4096, 'total_tokens': 5494, 'prompt_tokens_details': {'cached_tokens': 0}, 'prompt_cache_hit_tokens': 0, 'prompt_cache_miss_tokens': 1398}
2025-05-24 19:16:44,428 - AIPoliDoc - DEBUG - 原始响应内容长度: 11282 字符
2025-05-24 19:16:44,430 - AIPoliDoc - DEBUG - 响应内容开头: {
  "elements": [
    {
      "type": "标题",
      "content": "人工智能在学术论文排版中的应用研究",
      "format": {
        "font": "黑体",
        "size": "小二",
        "line_spacing": 1.0
      }
    },
    {
      "...
2025-05-24 19:16:44,441 - AIPoliDoc - DEBUG - 响应内容结尾: ... "微软雅黑",
        "size": "五号",
        "line_spacing": 19.0
      }
    },
    {
      "type": "正文",
      "content": "[3] 中文信息处理学会. 学术论文格式规范V3.2[S]. 2024.",
      "format": {
        "font": "微软雅黑",

2025-05-24 19:16:44,442 - AIPoliDoc - DEBUG - JSON内容起始位置: 0, 结束位置: 11154
2025-05-24 19:16:44,443 - AIPoliDoc - DEBUG - 提取的JSON内容长度: 11155 字符
2025-05-24 19:16:44,444 - AIPoliDoc - DEBUG - JSON内容前50个字符: {
  "elements": [
    {
      "type": "标题",
      ...
2025-05-24 19:16:44,449 - AIPoliDoc - ERROR - JSON解析失败: Expecting ',' delimiter: line 569 column 6 (char 11155)
2025-05-24 19:16:44,450 - AIPoliDoc - ERROR - 解析失败位置附近的内容: ...: "五号",
        "line_spacing": 19.0
      }
    }...
2025-05-24 19:16:44,451 - AIPoliDoc - ERROR - 解析失败位置: 11155, 行: 569, 列: 6
2025-05-24 19:16:59,558 - AIPoliDoc - ERROR - 排版任务失败: 解析AI响应失败
2025-05-24 20:08:41,008 - AIPoliDoc - DEBUG - 保存配置文件: config/app_config.json
2025-05-24 20:08:41,015 - AIPoliDoc - INFO - 应用程序正常关闭
